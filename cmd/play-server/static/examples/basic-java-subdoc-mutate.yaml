title: Sub-document Mutate
page: page-01
lang: java
code: |
  import com.couchbase.client.core.error.subdoc.PathNotFoundException;
  import com.couchbase.client.core.error.subdoc.PathExistsException;
  import com.couchbase.client.java.*;
  import com.couchbase.client.java.kv.LookupInResult;
  import static com.couchbase.client.java.kv.LookupInSpec.get;
  import static com.couchbase.client.java.kv.MutateInSpec.upsert;
  import java.util.Collections;
  import java.util.Arrays;
  
  class Program {
    public static void main(String[] args) {
      var cluster = Cluster.connect(
        "couchbase://{{.Host}}", "{{.CBUser}}", "{{.CBPswd}}"
      );
      var bucket = cluster.bucket("travel-sample");
      var collection = bucket.defaultCollection();

      try {
        LookupInResult result = collection.lookupIn(
          "airline_10", Collections.singletonList(get("country"))
        );

        var str = result.contentAs(0, String.class);
        System.out.println("Sub-doc before: ");
        System.out.println(str);
        
      } catch (PathNotFoundException e) {
        System.out.println("Sub-doc path not found!");
      }

      try {
        collection.mutateIn("airline_10", Arrays.asList(
          upsert("country", "Canada")
        ));
      } catch (PathExistsException e) {
        System.out.println("Sub-doc path not found!");
      }

      try {
        LookupInResult result = collection.lookupIn(
          "airline_10", Collections.singletonList(get("country"))
        );

        var str = result.contentAs(0, String.class);
        System.out.println("Sub-doc after: ");
        System.out.println(str);
        
      } catch (PathNotFoundException e) {
        System.out.println("Sub-doc path not found!");
      }
      
    }
  }
infoAfter: |
  Our Sub-document API allows for only retrieving or mutating a portion of 
  a larger document. For operations where you just need to update one field 
  in a document, this keeps you from having to query, change and send back an
  updated document and is more performant getting or setting in one operation. 
  Visit our docs to learn more about <a target="_blank" href="https://docs.couchbase.com/java-sdk/current/howtos/subdocument-operations.html#mutating">Mutating Sub-documents in Java</a>.